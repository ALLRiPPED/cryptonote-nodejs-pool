var _0x48d2=['balance','paid','lastShare','*Report\x20for\x20','...','substring','length','Last\x20share:\x20','Balance:\x20','Paid:\x20','*Active\x20Workers*\x0a','name','&type=default&address=','To\x20enable\x20or\x20disable\x20notifications\x20you\x20need\x20to\x20specify\x20the\x20miner\x20address\x20on\x20first\x20request','trim','&type=miner&address=','chatId','Enable\x20miner\x20notifications\x20to\x20@%s\x20(%s)\x20for\x20address:\x20%s','/set_telegram_notifications?chatId=','&action=enable','status','done','Miner\x20notifications\x20enabled\x20for\x20','&action=disable','Unable\x20to\x20disable\x20telegram\x20notifications:\x20','An\x20error\x20occurred.\x20Please\x20retry.','Miner\x20notifications\x20disabled\x20for\x20','Enable\x20blocks\x20notifications\x20to\x20@%s\x20(%s)','Unable\x20to\x20enable\x20telegram\x20notifications:\x20','&type=blocks&action=disable','Blocks\x20notifications\x20disabled','env','NTBA_FIX_319','time-ago','./apiInterfaces.js','daemon','wallet','./notifications.js','./utils.js','./exceptionWriter.js','telegram','Telegram\x20is\x20not\x20enabled','error','token','No\x20telegram\x20token\x20found\x20in\x20configuration','/stats','/report','/notify','/blocks','botCommands','assign','channel','channelStats','enabled','interval','info','onText','^/(start|help)$','chat','Commands\x20list\x20request\x20from\x20@%s\x20(%s)','from','username',',\x0a\x0a','Pool\x20statistics:\x20','stats','Blocks\x20notifications:\x20','blocks','report','\x20_address_\x0a','notify','\x20_address_\x0a\x0a','sendMessage','Markdown','Pool\x20statistics\x20request\x20from\x20@%s\x20(%s)','pool','Unable\x20to\x20get\x20API\x20data\x20for\x20stats:\x20','Unable\x20to\x20get\x20pool\x20statistics.\x20Please\x20retry.','poolHost','Pool','getReadableHashRate','hashrate','miners','workers','totalBlocks','lastBlockFound','ago','Never','network','difficulty','config','coinDifficultyTarget','N/A','height','getReadableCoins','lastblock','reward','timestamp','roundHashes','Blocks\x20Found:\x20','Last\x20Block:\x20','Hashrate:\x20','Difficulty:\x20','Block\x20Height:\x20','Last\x20Reward:\x20','/get_telegram_notifications?chatId=','address','\x20(.*)$','No\x20address\x20specified!','/stats_address?address=','Unable\x20to\x20get\x20API\x20data\x20for\x20miner\x20stats:\x20','Unable\x20to\x20get\x20miner\x20statistics.\x20Please\x20retry.','No\x20miner\x20statistics\x20found\x20for\x20that\x20address.\x20Please\x20check\x20the\x20address\x20and\x20try\x20again.'];(function(_0x3c5401,_0x5af32a){var _0x464438=function(_0x1338e2){while(--_0x1338e2){_0x3c5401['push'](_0x3c5401['shift']());}};_0x464438(++_0x5af32a);}(_0x48d2,0x8f));var _0x47d9=function(_0x91345a,_0x427e6a){_0x91345a=_0x91345a-0x0;var _0x45375e=_0x48d2[_0x91345a];return _0x45375e;};process[_0x47d9('0x0')][_0x47d9('0x1')]=0x1;let TelegramBot=require('node-telegram-bot-api');let timeAgo=require(_0x47d9('0x2'));let apiInterfaces=require(_0x47d9('0x3'))(config[_0x47d9('0x4')],config[_0x47d9('0x5')],config['api']);let notifications=require(_0x47d9('0x6'));let utils=require(_0x47d9('0x7'));let logSystem='telegramBot';require(_0x47d9('0x8'))(logSystem);if(!config[_0x47d9('0x9')]){log('error',logSystem,_0x47d9('0xa'));}else if(!config['telegram']['enabled']){log(_0x47d9('0xb'),logSystem,_0x47d9('0xa'));}else if(!config[_0x47d9('0x9')][_0x47d9('0xc')]){log(_0x47d9('0xb'),logSystem,_0x47d9('0xd'));}let botCommands={'stats':_0x47d9('0xe'),'report':_0x47d9('0xf'),'notify':_0x47d9('0x10'),'blocks':_0x47d9('0x11')};if(config[_0x47d9('0x9')][_0x47d9('0x12')]){Object[_0x47d9('0x13')](botCommands,config[_0x47d9('0x9')][_0x47d9('0x12')]);}let channel=config[_0x47d9('0x9')][_0x47d9('0x14')]['replace'](/@/g,'')||'';let periodicalStats=channel&&config[_0x47d9('0x9')][_0x47d9('0x15')]&&config[_0x47d9('0x9')][_0x47d9('0x15')][_0x47d9('0x16')];let statsInterval=config[_0x47d9('0x9')][_0x47d9('0x15')]&&config[_0x47d9('0x9')][_0x47d9('0x15')][_0x47d9('0x17')]>0x0?parseInt(config[_0x47d9('0x9')][_0x47d9('0x15')][_0x47d9('0x17')]):0x0;log(_0x47d9('0x18'),logSystem,'Started');let token=config[_0x47d9('0x9')][_0x47d9('0xc')];let bot=new TelegramBot(token,{'polling':!![]});if(periodicalStats&&statsInterval>0x0&&channel){log(_0x47d9('0x18'),logSystem,'Sending\x20pool\x20statistics\x20to\x20telegram\x20channel\x20@%s\x20each\x20%d\x20minutes',[channel,statsInterval]);setInterval(function(){sendPoolStats('@'+channel);},statsInterval*0x3c*0x3e8);}bot[_0x47d9('0x19')](new RegExp(_0x47d9('0x1a'),'i'),_0x28fcfc=>{if(_0x28fcfc['from']['id']!=_0x28fcfc[_0x47d9('0x1b')]['id'])return;log(_0x47d9('0x18'),logSystem,_0x47d9('0x1c'),[_0x28fcfc[_0x47d9('0x1d')]['username'],_0x28fcfc[_0x47d9('0x1d')]['id']]);let _0x2339ad='Hi\x20@'+_0x28fcfc[_0x47d9('0x1d')][_0x47d9('0x1e')]+_0x47d9('0x1f')+'Here\x20are\x20the\x20commands\x20you\x20can\x20use:\x0a\x0a'+_0x47d9('0x20')+botCommands[_0x47d9('0x21')]+'\x0a'+_0x47d9('0x22')+botCommands[_0x47d9('0x23')]+'\x0a'+'Miner\x20statistics:\x20'+botCommands[_0x47d9('0x24')]+_0x47d9('0x25')+'Miner\x20notifications:\x20'+botCommands[_0x47d9('0x26')]+_0x47d9('0x27')+'Thank\x20you!';bot[_0x47d9('0x28')](_0x28fcfc[_0x47d9('0x1d')]['id'],_0x2339ad,{'parse_mode':_0x47d9('0x29')});});bot[_0x47d9('0x19')](new RegExp('^'+botCommands[_0x47d9('0x21')]+'$','i'),_0x1d5635=>{log(_0x47d9('0x18'),logSystem,_0x47d9('0x2a'),[_0x1d5635[_0x47d9('0x1d')][_0x47d9('0x1e')],_0x1d5635[_0x47d9('0x1d')]['id']]);sendPoolStats(_0x1d5635['chat']['id']);});function sendPoolStats(_0x9e3e6f){apiInterfaces[_0x47d9('0x2b')](_0x47d9('0xe'),function(_0x1f6cfd,_0x4ae946){if(_0x1f6cfd||!_0x4ae946){log(_0x47d9('0xb'),logSystem,_0x47d9('0x2c')+_0x1f6cfd);return bot[_0x47d9('0x28')](id,_0x47d9('0x2d'));}let _0x506c67=config[_0x47d9('0x2e')]||_0x47d9('0x2f');let _0x5d66ec=utils[_0x47d9('0x30')](_0x4ae946[_0x47d9('0x2b')][_0x47d9('0x31')]);let _0x45f9a8=_0x4ae946[_0x47d9('0x2b')][_0x47d9('0x32')]||0x0;let _0x17e396=_0x4ae946[_0x47d9('0x2b')][_0x47d9('0x33')]||0x0;let _0x18aa31=_0x4ae946[_0x47d9('0x2b')][_0x47d9('0x34')]||0x0;let _0x5991a9=_0x4ae946['pool'][_0x47d9('0x35')]?timeAgo[_0x47d9('0x36')](new Date(parseInt(_0x4ae946['pool'][_0x47d9('0x35')]))):_0x47d9('0x37');let _0x4c019e=utils['getReadableHashRate'](_0x4ae946[_0x47d9('0x38')][_0x47d9('0x39')]/_0x4ae946[_0x47d9('0x3a')][_0x47d9('0x3b')]);let _0x1e0332=_0x4ae946['network'][_0x47d9('0x39')]||_0x47d9('0x3c');let _0x22441d=_0x4ae946[_0x47d9('0x38')][_0x47d9('0x3d')]||_0x47d9('0x3c');let _0x4dfc22=utils[_0x47d9('0x3e')](_0x4ae946[_0x47d9('0x3f')][_0x47d9('0x40')]);let _0x2437a2=_0x4ae946[_0x47d9('0x3f')][_0x47d9('0x41')]?timeAgo[_0x47d9('0x36')](new Date(parseInt(_0x4ae946[_0x47d9('0x3f')][_0x47d9('0x41')]*0x3e8))):_0x47d9('0x37');let _0x2f142a=_0x4ae946['pool'][_0x47d9('0x42')]?(_0x4ae946[_0x47d9('0x2b')][_0x47d9('0x42')]/_0x4ae946[_0x47d9('0x38')][_0x47d9('0x39')]*0x64)['toFixed'](0x1)+'%':'0%';let _0x2c2e53='';_0x2c2e53+='*'+_0x506c67+'*\x0a';_0x2c2e53+='Hashrate:\x20'+_0x5d66ec+'\x0a';_0x2c2e53+='Connected\x20Miners:\x20'+_0x45f9a8+'\x0a';_0x2c2e53+='Active\x20Workers:\x20'+_0x17e396+'\x0a';_0x2c2e53+=_0x47d9('0x43')+_0x18aa31+'\x0a';_0x2c2e53+=_0x47d9('0x44')+_0x5991a9+'\x0a';_0x2c2e53+='Current\x20Effort:\x20'+_0x2f142a+'\x0a';_0x2c2e53+='\x0a';_0x2c2e53+='*Network*\x0a';_0x2c2e53+=_0x47d9('0x45')+_0x4c019e+'\x0a';_0x2c2e53+=_0x47d9('0x46')+_0x1e0332+'\x0a';_0x2c2e53+=_0x47d9('0x47')+_0x22441d+'\x0a';_0x2c2e53+='Block\x20Found:\x20'+_0x2437a2+'\x0a';_0x2c2e53+=_0x47d9('0x48')+_0x4dfc22;return bot[_0x47d9('0x28')](_0x9e3e6f,_0x2c2e53,{'parse_mode':'Markdown'});});}bot[_0x47d9('0x19')](new RegExp('^'+botCommands[_0x47d9('0x24')]+'$','i'),_0x41eefd=>{if(_0x41eefd['from']['id']!=_0x41eefd[_0x47d9('0x1b')]['id'])return;let _0x25bec2=_0x47d9('0x49')+_0x41eefd[_0x47d9('0x1d')]['id']+'&type=default';apiInterfaces[_0x47d9('0x2b')](_0x25bec2,function(_0x1a4aa9,_0x5652de){if(_0x5652de[_0x47d9('0x4a')]){sendMinerStats(_0x41eefd,_0x5652de[_0x47d9('0x4a')]);}else{let _0xde5bbc='To\x20display\x20miner\x20report\x20you\x20need\x20to\x20specify\x20the\x20miner\x20address\x20on\x20first\x20request';bot[_0x47d9('0x28')](_0x41eefd['from']['id'],_0xde5bbc,{'parse_mode':'Markdown'});}});});bot[_0x47d9('0x19')](new RegExp('^'+botCommands[_0x47d9('0x24')]+_0x47d9('0x4b'),'i'),(_0x103623,_0x5ceba0)=>{if(_0x103623[_0x47d9('0x1d')]['id']!=_0x103623['chat']['id'])return;let _0x1b21de=_0x5ceba0&&_0x5ceba0[0x1]?_0x5ceba0[0x1]['trim']():'';if(!_0x1b21de||_0x1b21de==''){return bot[_0x47d9('0x28')](_0x103623['from']['id'],_0x47d9('0x4c'));}sendMinerStats(_0x103623,_0x1b21de);});function sendMinerStats(_0x8725c5,_0x23d4de){log(_0x47d9('0x18'),logSystem,'Miner\x20report\x20request\x20from\x20@%s\x20(%s)\x20for\x20address:\x20%s',[_0x8725c5[_0x47d9('0x1d')][_0x47d9('0x1e')],_0x8725c5[_0x47d9('0x1d')]['id'],_0x23d4de]);apiInterfaces[_0x47d9('0x2b')](_0x47d9('0x4d')+_0x23d4de,function(_0x1b4c65,_0xf03102){if(_0x1b4c65||!_0xf03102){log(_0x47d9('0xb'),logSystem,_0x47d9('0x4e')+_0x1b4c65);return bot[_0x47d9('0x28')](_0x8725c5[_0x47d9('0x1d')]['id'],_0x47d9('0x4f'));}if(!_0xf03102[_0x47d9('0x21')]){return bot[_0x47d9('0x28')](_0x8725c5[_0x47d9('0x1d')]['id'],_0x47d9('0x50'));}let _0x4a34bd=utils[_0x47d9('0x30')](_0xf03102[_0x47d9('0x21')][_0x47d9('0x31')]);let _0x41303f=utils[_0x47d9('0x3e')](_0xf03102['stats'][_0x47d9('0x51')]);let _0x43754b=utils[_0x47d9('0x3e')](_0xf03102[_0x47d9('0x21')][_0x47d9('0x52')]);let _0x594acc=timeAgo['ago'](new Date(parseInt(_0xf03102[_0x47d9('0x21')][_0x47d9('0x53')]*0x3e8)));let _0x538af7=_0x47d9('0x54')+_0x23d4de['substring'](0x0,0x7)+_0x47d9('0x55')+_0x23d4de[_0x47d9('0x56')](_0x23d4de[_0x47d9('0x57')]-0x7)+'*\x0a';_0x538af7+=_0x47d9('0x45')+_0x4a34bd+'\x0a';_0x538af7+=_0x47d9('0x58')+_0x594acc+'\x0a';_0x538af7+=_0x47d9('0x59')+_0x41303f+'\x0a';_0x538af7+=_0x47d9('0x5a')+_0x43754b+'\x0a';if(_0xf03102[_0x47d9('0x33')]&&_0xf03102[_0x47d9('0x33')][_0x47d9('0x57')]>0x0){let _0x516390=!![];for(let _0x5b5be3 in _0xf03102[_0x47d9('0x33')]){if(!_0xf03102['workers'][_0x5b5be3]||!_0xf03102[_0x47d9('0x33')][_0x5b5be3]['hashrate']||_0xf03102[_0x47d9('0x33')][_0x5b5be3][_0x47d9('0x31')]===0x0)continue;if(_0x516390){_0x538af7+='\x0a';_0x538af7+=_0x47d9('0x5b');}let _0x437728=_0xf03102[_0x47d9('0x33')][_0x5b5be3][_0x47d9('0x5c')];let _0x2159ae=utils['getReadableHashRate'](_0xf03102[_0x47d9('0x33')][_0x5b5be3][_0x47d9('0x31')]);_0x538af7+=_0x437728+':\x20'+_0x2159ae+'\x0a';_0x516390=![];}}bot[_0x47d9('0x28')](_0x8725c5['from']['id'],_0x538af7,{'parse_mode':_0x47d9('0x29')});let _0x3690c6='/set_telegram_notifications?chatId='+_0x8725c5['from']['id']+_0x47d9('0x5d')+_0x23d4de;apiInterfaces[_0x47d9('0x2b')](_0x3690c6,function(_0x1b4c65,_0x538af7){});});}bot[_0x47d9('0x19')](new RegExp('^'+botCommands[_0x47d9('0x26')]+'$','i'),_0x427143=>{if(_0x427143['from']['id']!=_0x427143[_0x47d9('0x1b')]['id'])return;let _0x45af45='/get_telegram_notifications?chatId='+_0x427143[_0x47d9('0x1d')]['id']+'&type=default';apiInterfaces[_0x47d9('0x2b')](_0x45af45,function(_0x1e2c81,_0x13f649){if(_0x13f649['address']){toggleMinerNotifications(_0x427143,_0x13f649[_0x47d9('0x4a')]);}else{let _0x39f08e=_0x47d9('0x5e');bot[_0x47d9('0x28')](_0x427143[_0x47d9('0x1d')]['id'],_0x39f08e,{'parse_mode':'Markdown'});}});});bot[_0x47d9('0x19')](new RegExp('^'+botCommands['notify']+_0x47d9('0x4b'),'i'),(_0x247675,_0x314847)=>{if(_0x247675[_0x47d9('0x1d')]['id']!=_0x247675[_0x47d9('0x1b')]['id'])return;let _0x26071d=_0x314847&&_0x314847[0x1]?_0x314847[0x1][_0x47d9('0x5f')]():'';if(!_0x26071d||_0x26071d==''){return bot[_0x47d9('0x28')](_0x247675[_0x47d9('0x1d')]['id'],'No\x20address\x20specified!');}toggleMinerNotifications(_0x247675,_0x26071d);});function toggleMinerNotifications(_0x477bad,_0xb1e5e3){let _0x45a826=_0x47d9('0x49')+_0x477bad[_0x47d9('0x1d')]['id']+_0x47d9('0x60')+_0xb1e5e3;apiInterfaces[_0x47d9('0x2b')](_0x45a826,function(_0x498ec2,_0x5e4a57){if(_0x5e4a57[_0x47d9('0x61')]&&_0x5e4a57[_0x47d9('0x61')]==_0x477bad[_0x47d9('0x1d')]['id']){disableMinerNotifications(_0x477bad,_0xb1e5e3);}else{enableMinerNotifications(_0x477bad,_0xb1e5e3);}});}function enableMinerNotifications(_0x172826,_0x39d835){log(_0x47d9('0x18'),logSystem,_0x47d9('0x62'),[_0x172826[_0x47d9('0x1d')][_0x47d9('0x1e')],_0x172826['from']['id'],_0x39d835]);let _0x33155a=_0x47d9('0x63')+_0x172826['from']['id']+'&type=miner&address='+_0x39d835+_0x47d9('0x64');apiInterfaces[_0x47d9('0x2b')](_0x33155a,function(_0x107732,_0x59ecd6){if(_0x107732){log(_0x47d9('0xb'),logSystem,'Unable\x20to\x20enable\x20telegram\x20notifications:\x20'+_0x107732);return bot[_0x47d9('0x28')](_0x172826[_0x47d9('0x1d')]['id'],'An\x20error\x20occurred.\x20Please\x20retry.');}if(_0x59ecd6[_0x47d9('0x65')]!=_0x47d9('0x66')){return bot['sendMessage'](_0x172826[_0x47d9('0x1d')]['id'],_0x59ecd6[_0x47d9('0x65')]);}bot['sendMessage'](_0x172826[_0x47d9('0x1d')]['id'],_0x47d9('0x67')+_0x39d835[_0x47d9('0x56')](0x0,0x7)+_0x47d9('0x55')+_0x39d835[_0x47d9('0x56')](_0x39d835['length']-0x7));let _0x33155a=_0x47d9('0x63')+_0x172826[_0x47d9('0x1d')]['id']+_0x47d9('0x5d')+_0x39d835;apiInterfaces['pool'](_0x33155a,function(_0x107732,_0x59ecd6){});});}function disableMinerNotifications(_0x4e3f20,_0x46d126){log(_0x47d9('0x18'),logSystem,'Disable\x20miner\x20notifications\x20to\x20@%s\x20(%s)\x20for\x20address:\x20%s',[_0x4e3f20[_0x47d9('0x1d')][_0x47d9('0x1e')],_0x4e3f20[_0x47d9('0x1d')]['id'],_0x46d126]);let _0xecf617=_0x47d9('0x63')+_0x4e3f20[_0x47d9('0x1d')]['id']+_0x47d9('0x60')+_0x46d126+_0x47d9('0x68');apiInterfaces[_0x47d9('0x2b')](_0xecf617,function(_0x14f6a9,_0x3429fe){if(_0x14f6a9){log(_0x47d9('0xb'),logSystem,_0x47d9('0x69')+_0x14f6a9);return bot[_0x47d9('0x28')](_0x4e3f20[_0x47d9('0x1d')]['id'],_0x47d9('0x6a'));}if(_0x3429fe[_0x47d9('0x65')]!=_0x47d9('0x66')){return bot['sendMessage'](_0x4e3f20[_0x47d9('0x1d')]['id'],_0x3429fe[_0x47d9('0x65')]);}bot[_0x47d9('0x28')](_0x4e3f20[_0x47d9('0x1d')]['id'],_0x47d9('0x6b')+_0x46d126[_0x47d9('0x56')](0x0,0x7)+'...'+_0x46d126[_0x47d9('0x56')](_0x46d126[_0x47d9('0x57')]-0x7));let _0xecf617=_0x47d9('0x63')+_0x4e3f20[_0x47d9('0x1d')]['id']+_0x47d9('0x5d')+_0x46d126;apiInterfaces['pool'](_0xecf617,function(_0x14f6a9,_0x3429fe){});});}bot[_0x47d9('0x19')](new RegExp('^'+botCommands[_0x47d9('0x23')]+'$','i'),_0x3c7fc3=>{if(_0x3c7fc3[_0x47d9('0x1d')]['id']!=_0x3c7fc3[_0x47d9('0x1b')]['id'])return;toggleBlocksNotifications(_0x3c7fc3);});function toggleBlocksNotifications(_0x8347e6){let _0x1b26f6=_0x47d9('0x49')+_0x8347e6['from']['id']+'&type=blocks';apiInterfaces[_0x47d9('0x2b')](_0x1b26f6,function(_0x5068cf,_0x2e068d){if(_0x5068cf){return bot[_0x47d9('0x28')](_0x8347e6[_0x47d9('0x1d')]['id'],_0x47d9('0x6a'));}if(_0x2e068d[_0x47d9('0x16')]){disableBlocksNotifications(_0x8347e6);}else{enableBlocksNotifications(_0x8347e6);}});}function enableBlocksNotifications(_0x252c6c){log(_0x47d9('0x18'),logSystem,_0x47d9('0x6c'),[_0x252c6c[_0x47d9('0x1d')][_0x47d9('0x1e')],_0x252c6c[_0x47d9('0x1d')]['id']]);let _0x407c1e=_0x47d9('0x63')+_0x252c6c['from']['id']+'&type=blocks&action=enable';apiInterfaces[_0x47d9('0x2b')](_0x407c1e,function(_0x4d2e01,_0x829495){if(_0x4d2e01){log(_0x47d9('0xb'),logSystem,_0x47d9('0x6d')+_0x4d2e01);return bot[_0x47d9('0x28')](_0x252c6c[_0x47d9('0x1d')]['id'],_0x47d9('0x6a'));}if(_0x829495[_0x47d9('0x65')]!=_0x47d9('0x66')){return bot[_0x47d9('0x28')](_0x252c6c[_0x47d9('0x1d')]['id'],_0x829495[_0x47d9('0x65')]);}return bot[_0x47d9('0x28')](_0x252c6c[_0x47d9('0x1d')]['id'],'Blocks\x20notifications\x20enabled');});}function disableBlocksNotifications(_0x499795){log(_0x47d9('0x18'),logSystem,'Disable\x20blocks\x20notifications\x20to\x20@%s\x20(%s)',[_0x499795[_0x47d9('0x1d')]['username'],_0x499795[_0x47d9('0x1d')]['id']]);let _0x16dbbf=_0x47d9('0x63')+_0x499795[_0x47d9('0x1d')]['id']+_0x47d9('0x6e');apiInterfaces['pool'](_0x16dbbf,function(_0xc10580,_0x3e3434){if(_0xc10580){log('error',logSystem,_0x47d9('0x69')+_0xc10580);return bot[_0x47d9('0x28')](_0x499795[_0x47d9('0x1d')]['id'],_0x47d9('0x6a'));}if(_0x3e3434['status']!=_0x47d9('0x66')){return bot[_0x47d9('0x28')](_0x499795[_0x47d9('0x1d')]['id'],_0x3e3434[_0x47d9('0x65')]);}return bot[_0x47d9('0x28')](_0x499795[_0x47d9('0x1d')]['id'],_0x47d9('0x6f'));});}
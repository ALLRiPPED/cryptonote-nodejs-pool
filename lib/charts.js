var _0x53ea=['/workers_hashrate','Unable\x20to\x20get\x20API\x20data\x20for\x20workers_hashrate:\x20','workersHashrate','substr','hashrate:','length','unshift','split','prices','source','symbol','toUpperCase','price','No\x20exchange\x20data\x20for\x20','\x20to\x20','\x20using\x20','coinUnits','mget','parallel','exports','http','./apiInterfaces.js','daemon','wallet','api','redis','cleanupInterval','charts','./exceptionWriter.js','keys','pool','enabled','updateInterval','user','hashrate','worker_hashrate','avg','round','avgRound','max','stepInterval','push','maximumPeriod','shift','search','coin','stringify','set','info','\x20chart\x20collected\x20value\x20','.\x20Total\x20sets\x20count\x20','waterfall','get','parse',':charts:','/stats','error','Unable\x20to\x20get\x20API\x20data\x20for\x20stats:\x20','miners','workers','network','difficulty','Unable\x20to\x20get\x20API\x20data\x20for\x20miners_hashrate:\x20','minersHashrate'];(function(_0xb67384,_0x27295a){var _0x156d7c=function(_0x52a1f8){while(--_0x52a1f8){_0xb67384['push'](_0xb67384['shift']());}};_0x156d7c(++_0x27295a);}(_0x53ea,0xd4));var _0x2249=function(_0xe3b9ac,_0x2eb2ed){_0xe3b9ac=_0xe3b9ac-0x0;var _0x287d38=_0x53ea[_0xe3b9ac];return _0x287d38;};let fs=require('fs');let async=require('async');let http=require(_0x2249('0x0'));let apiInterfaces=require(_0x2249('0x1'))(config[_0x2249('0x2')],config[_0x2249('0x3')],config[_0x2249('0x4')]);let market=require('./market.js');let cleanupInterval=config[_0x2249('0x5')][_0x2249('0x6')]&&config[_0x2249('0x5')]['cleanupInterval']>0x0?config[_0x2249('0x5')]['cleanupInterval']:0xf;let logSystem=_0x2249('0x7');require(_0x2249('0x8'))(logSystem);function startDataCollectors(){async['each'](Object[_0x2249('0x9')](config[_0x2249('0x7')][_0x2249('0xa')]),function(_0x30115c){let _0x252910=config['charts']['pool'][_0x30115c];if(_0x252910[_0x2249('0xb')]){setInterval(function(){collectPoolStatWithInterval(_0x30115c,_0x252910);},_0x252910[_0x2249('0xc')]*0x3e8);}});let _0x366f38=config[_0x2249('0x7')][_0x2249('0xd')]['hashrate'];if(_0x366f38[_0x2249('0xb')]){setInterval(function(){collectUsersHashrate(_0x2249('0xe'),_0x366f38);},_0x366f38[_0x2249('0xc')]*0x3e8);}let _0xdb1612=config[_0x2249('0x7')]['user'][_0x2249('0xf')];if(_0xdb1612&&_0xdb1612[_0x2249('0xb')]){setInterval(function(){collectWorkersHashrate(_0x2249('0xf'),_0xdb1612);},_0xdb1612[_0x2249('0xc')]*0x3e8);}}let chartStatFuncs={'hashrate':getPoolHashrate,'miners':getPoolMiners,'workers':getPoolWorkers,'difficulty':getNetworkDifficulty,'price':getCoinPrice,'profit':getCoinProfit};let statValueHandler={'avg':function(_0x28f0ea,_0x16c358){_0x28f0ea[0x1]=(_0x28f0ea[0x1]*_0x28f0ea[0x2]+_0x16c358)/(_0x28f0ea[0x2]+0x1);},'avgRound':function(_0x5be005,_0x13be60){statValueHandler[_0x2249('0x10')](_0x5be005,_0x13be60);_0x5be005[0x1]=Math[_0x2249('0x11')](_0x5be005[0x1]);},'max':function(_0x5b1c25,_0x578d78){if(_0x578d78>_0x5b1c25[0x1]){_0x5b1c25[0x1]=_0x578d78;}}};let preSaveFunctions={'hashrate':statValueHandler[_0x2249('0x12')],'workers':statValueHandler[_0x2249('0x13')],'difficulty':statValueHandler[_0x2249('0x12')],'price':statValueHandler[_0x2249('0x10')],'profit':statValueHandler[_0x2249('0x10')]};function storeCollectedValues(_0x56dea5,_0x3ab43e,_0x362570){for(let _0x2f41e3 in _0x3ab43e){storeCollectedValue(_0x56dea5+':'+_0x2f41e3,_0x3ab43e[_0x2f41e3],_0x362570);}}function storeCollectedValue(_0x2bb37a,_0x20ff95,_0x4923cc){let _0x2c57ee=new Date()/0x3e8|0x0;getChartDataFromRedis(_0x2bb37a,function(_0x23122b){let _0x53fba2=_0x23122b[_0x23122b['length']-0x1];if(!_0x53fba2||_0x2c57ee-_0x53fba2[0x0]>_0x4923cc[_0x2249('0x14')]){_0x53fba2=[_0x2c57ee,_0x20ff95,0x1];_0x23122b[_0x2249('0x15')](_0x53fba2);while(_0x2c57ee-_0x23122b[0x0][0x0]>_0x4923cc[_0x2249('0x16')]){_0x23122b[_0x2249('0x17')]();}}else{preSaveFunctions[_0x2bb37a]?preSaveFunctions[_0x2bb37a](_0x53fba2,_0x20ff95):statValueHandler[_0x2249('0x12')](_0x53fba2,_0x20ff95);_0x53fba2[0x2]++;}if(getStatsRedisKey(_0x2bb37a)[_0x2249('0x18')](config[_0x2249('0x19')]+':charts:hashrate')>=0x0){redisClient['set'](getStatsRedisKey(_0x2bb37a),JSON[_0x2249('0x1a')](_0x23122b),'EX',0x15180*cleanupInterval);}else{redisClient[_0x2249('0x1b')](getStatsRedisKey(_0x2bb37a),JSON[_0x2249('0x1a')](_0x23122b));}log(_0x2249('0x1c'),logSystem,_0x2bb37a+_0x2249('0x1d')+_0x20ff95+_0x2249('0x1e')+_0x23122b['length']);});}function collectPoolStatWithInterval(_0x5233cb,_0x2c82bd){async[_0x2249('0x1f')]([chartStatFuncs[_0x5233cb],function(_0x253b5e,_0x411210){storeCollectedValue(_0x5233cb,_0x253b5e,_0x2c82bd,_0x411210);}]);}function getChartDataFromRedis(_0x14f832,_0x1c9f9d){redisClient[_0x2249('0x20')](getStatsRedisKey(_0x14f832),function(_0x456193,_0x19ec8c){_0x1c9f9d(_0x19ec8c?JSON[_0x2249('0x21')](_0x19ec8c):[]);});}function getStatsRedisKey(_0x2e1ad3){return config[_0x2249('0x19')]+_0x2249('0x22')+_0x2e1ad3;}function getPoolStats(_0x4b5add){apiInterfaces[_0x2249('0xa')](_0x2249('0x23'),function(_0x4b0326,_0x381e9e){if(_0x4b0326){log(_0x2249('0x24'),logSystem,_0x2249('0x25')+_0x4b0326);}_0x4b5add(_0x4b0326,_0x381e9e);});}function getPoolHashrate(_0x456219){getPoolStats(function(_0x5c8910,_0x5c60cd){_0x456219(_0x5c8910,_0x5c60cd[_0x2249('0xa')]?Math[_0x2249('0x11')](_0x5c60cd[_0x2249('0xa')][_0x2249('0xe')]):null);});}function getPoolMiners(_0x351b50){getPoolStats(function(_0x19a72a,_0x184be1){_0x351b50(_0x19a72a,_0x184be1[_0x2249('0xa')]?_0x184be1['pool'][_0x2249('0x26')]:null);});}function getPoolWorkers(_0x365a13){getPoolStats(function(_0x20973a,_0x31dfff){_0x365a13(_0x20973a,_0x31dfff[_0x2249('0xa')]?_0x31dfff['pool'][_0x2249('0x27')]:null);});}function getNetworkDifficulty(_0x594b47){getPoolStats(function(_0x3c4d49,_0x4a9b6b){_0x594b47(_0x3c4d49,_0x4a9b6b[_0x2249('0xa')]?_0x4a9b6b[_0x2249('0x28')][_0x2249('0x29')]:null);});}function getUsersHashrates(_0x2c2eec){apiInterfaces[_0x2249('0xa')]('/miners_hashrate',function(_0x2669b8,_0x2ec9fd){if(_0x2669b8){log(_0x2249('0x24'),logSystem,_0x2249('0x2a')+_0x2669b8);}let _0x4561f1=_0x2ec9fd&&_0x2ec9fd[_0x2249('0x2b')]?_0x2ec9fd[_0x2249('0x2b')]:{};_0x2c2eec(_0x4561f1);});}function getWorkersHashrates(_0x3029a0){apiInterfaces[_0x2249('0xa')](_0x2249('0x2c'),function(_0x3717d9,_0x4a51fe){if(_0x3717d9){log(_0x2249('0x24'),logSystem,_0x2249('0x2d')+_0x3717d9);}let _0x1027ae=_0x4a51fe&&_0x4a51fe[_0x2249('0x2e')]?_0x4a51fe['workersHashrate']:{};_0x3029a0(_0x1027ae);});}function collectUsersHashrate(_0x51ce59,_0x2efefc){let _0x44871d=getStatsRedisKey(_0x51ce59)+':';redisClient['keys'](_0x44871d+'*',function(_0x350e2f){let _0x4f3b12={};for(let _0x2a8964 in _0x350e2f){_0x4f3b12[_0x350e2f[_0x2a8964][_0x2249('0x2f')](_0x44871d['length'])]=0x0;}getUsersHashrates(function(_0x502249){for(let _0x1ecb01 in _0x502249){_0x4f3b12[_0x1ecb01]=_0x502249[_0x1ecb01];}storeCollectedValues(_0x51ce59,_0x4f3b12,_0x2efefc);});});}function getUserHashrateChartData(_0x506daa,_0x24e038){getChartDataFromRedis(_0x2249('0x30')+_0x506daa,_0x24e038);}function collectWorkersHashrate(_0x4fc52f,_0x4541fb){let _0x4020fb=getStatsRedisKey(_0x4fc52f)+':';redisClient['keys'](_0x4020fb+'*',function(_0x1cab29){let _0x51b73e={};for(let _0x2b5253 in _0x1cab29){_0x51b73e[_0x1cab29[_0x2b5253][_0x2249('0x2f')](_0x4020fb[_0x2249('0x31')])]=0x0;}getWorkersHashrates(function(_0x4277e8){for(let _0x1a9629 in _0x4277e8){_0x51b73e[_0x1a9629]=_0x4277e8[_0x1a9629];}storeCollectedValues(_0x4fc52f,_0x51b73e,_0x4541fb);});});}function convertPaymentsDataToChart(_0x13e2ff){let _0x5a0499=[];if(_0x13e2ff&&_0x13e2ff[_0x2249('0x31')]){for(let _0x4bb5ef=0x0;_0x13e2ff[_0x4bb5ef];_0x4bb5ef+=0x2){_0x5a0499[_0x2249('0x32')]([+_0x13e2ff[_0x4bb5ef+0x1],_0x13e2ff[_0x4bb5ef][_0x2249('0x33')](':')[0x1]]);}}return _0x5a0499;}function getCoinPrice(_0x264218){let _0x3d084=config[_0x2249('0x34')][_0x2249('0x35')];let _0x433c6f=config[_0x2249('0x34')]['currency'];let _0x2c22f5=[config[_0x2249('0x36')][_0x2249('0x37')]()+'-'+_0x433c6f[_0x2249('0x37')]()];market[_0x2249('0x20')](_0x3d084,_0x2c22f5,function(_0x459ec2){let _0x42dde1=!_0x459ec2||!_0x459ec2[0x0]||!_0x459ec2[0x0][_0x2249('0x38')]?_0x2249('0x39')+config[_0x2249('0x36')][_0x2249('0x37')]()+_0x2249('0x3a')+_0x433c6f['toUpperCase']()+_0x2249('0x3b')+_0x3d084:null;let _0x28ade2=_0x459ec2&&_0x459ec2[0x0]&&_0x459ec2[0x0][_0x2249('0x38')]?_0x459ec2[0x0][_0x2249('0x38')]:null;_0x264218(_0x42dde1,_0x28ade2);});}function getCoinProfit(_0x18a933){getCoinPrice(function(_0x83b4de,_0x3dfc46){if(_0x83b4de){_0x18a933(_0x83b4de);return;}getPoolStats(function(_0x83b4de,_0x5a31ef){if(_0x83b4de){_0x18a933(_0x83b4de);return;}_0x18a933(null,_0x5a31ef['lastblock']['reward']*_0x3dfc46/_0x5a31ef[_0x2249('0x28')][_0x2249('0x29')]/config[_0x2249('0x3c')]);});});}function getPoolChartsData(_0x2a6616){let _0x315e2d=[];let _0x4a136e=[];for(let _0x1beb68 in config[_0x2249('0x7')][_0x2249('0xa')]){if(config[_0x2249('0x7')][_0x2249('0xa')][_0x1beb68][_0x2249('0xb')]){_0x315e2d[_0x2249('0x15')](_0x1beb68);_0x4a136e[_0x2249('0x15')](getStatsRedisKey(_0x1beb68));}}if(_0x4a136e[_0x2249('0x31')]){redisClient[_0x2249('0x3d')](_0x4a136e,function(_0x34f660,_0xd95e2b){let _0x38fb95={};if(_0xd95e2b){for(let _0x1f4676 in _0xd95e2b){if(_0xd95e2b[_0x1f4676]){_0x38fb95[_0x315e2d[_0x1f4676]]=JSON[_0x2249('0x21')](_0xd95e2b[_0x1f4676]);}}}_0x2a6616(_0x34f660,_0x38fb95);});}else{_0x2a6616(null,{});}}function getUserChartsData(_0x270917,_0x199b1b,_0x2e1ec2){let _0x2d311e={};let _0x51f60f={'hashrate':function(_0x2e1ec2){getUserHashrateChartData(_0x270917,function(_0x2211c7){_0x2e1ec2(null,_0x2211c7);});},'payments':function(_0x2e1ec2){_0x2e1ec2(null,convertPaymentsDataToChart(_0x199b1b));}};for(let _0x13e803 in _0x51f60f){if(!config[_0x2249('0x7')]['user'][_0x13e803][_0x2249('0xb')]){delete _0x51f60f[_0x13e803];}}async[_0x2249('0x3e')](_0x51f60f,_0x2e1ec2);}module[_0x2249('0x3f')]={'startDataCollectors':startDataCollectors,'getUserChartsData':getUserChartsData,'getPoolChartsData':getPoolChartsData};
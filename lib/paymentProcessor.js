var _0x82fa=['poolServer','paymentId','addressSeparator','priority','waterfall','keys','coin',':workers:*','error','Error\x20trying\x20to\x20get\x20worker\x20balances\x20from\x20redis\x20%j','map','hget','balance','multi','exec','Error\x20with\x20getting\x20balances\x20from\x20redis\x20%j','length','minPayoutLevel','split','maxPayment','Using\x20payout\x20level\x20of\x20%s\x20for\x20%s\x20(default:\x20%s)','getReadableCoins','denomination','dynamicTransferFee','minerPayFee','No\x20workers\x27\x20balances\x20reached\x20the\x20minimum\x20payment\x20threshold','maxTransactionAmount','replace','fixedDiff','enabled','transferFee','rpc','destinations','push','payment_id','redis',':workers:','hincrby','paid','amount','fee','maxAddresses','default','sendTransaction','unlock_time','rpcWallet','Payments\x20failed\x20to\x20send\x20to\x20%j','now','bytecoin','transactionHash','tx_hash',':payments:all','join','zadd',':payments:','address','mixin','Payments\x20sent\x20via\x20wallet\x20daemon\x20%j','Super\x20critical\x20error!\x20Payments\x20sent\x20yet\x20failing\x20to\x20update\x20balance\x20in\x20redis,\x20double\x20payouts\x20likely\x20to\x20happen\x20%j','Double\x20payments\x20likely\x20to\x20be\x20sent\x20to\x20%j','Payment\x20of\x20%s\x20to\x20%s','sendToMiner','payment','substring','...','interval','async','./apiInterfaces.js','wallet','./utils.js','payments','./exceptionWriter.js','info'];(function(_0xf7cd68,_0x357305){var _0xcb8a60=function(_0x20720a){while(--_0x20720a){_0xf7cd68['push'](_0xf7cd68['shift']());}};_0xcb8a60(++_0x357305);}(_0x82fa,0x11d));var _0x440a=function(_0x93627e,_0x477aec){_0x93627e=_0x93627e-0x0;var _0x49e0ec=_0x82fa[_0x93627e];return _0x49e0ec;};let fs=require('fs');let async=require(_0x440a('0x0'));let apiInterfaces=require(_0x440a('0x1'))(config['daemon'],config[_0x440a('0x2')],config['api']);let notifications=require('./notifications.js');let utils=require(_0x440a('0x3'));let logSystem=_0x440a('0x4');require(_0x440a('0x5'))(logSystem);log(_0x440a('0x6'),logSystem,'Started');if(!config[_0x440a('0x7')][_0x440a('0x8')])config[_0x440a('0x7')][_0x440a('0x8')]={};if(!config[_0x440a('0x7')][_0x440a('0x8')][_0x440a('0x9')])config['poolServer'][_0x440a('0x8')][_0x440a('0x9')]='+';if(!config[_0x440a('0x4')][_0x440a('0xa')])config[_0x440a('0x4')]['priority']=0x0;function runInterval(){async[_0x440a('0xb')]([function(_0x3ec482){redisClient[_0x440a('0xc')](config[_0x440a('0xd')]+_0x440a('0xe'),function(_0x430bd5,_0x384fb0){if(_0x430bd5){log(_0x440a('0xf'),logSystem,_0x440a('0x10'),[_0x430bd5]);_0x3ec482(!![]);return;}_0x3ec482(null,_0x384fb0);});},function(_0x54e94d,_0x498290){let _0x28b7bc=_0x54e94d[_0x440a('0x11')](function(_0x194667){return[_0x440a('0x12'),_0x194667,_0x440a('0x13')];});redisClient[_0x440a('0x14')](_0x28b7bc)[_0x440a('0x15')](function(_0x1f6766,_0x39f637){if(_0x1f6766){log(_0x440a('0xf'),logSystem,_0x440a('0x16'),[_0x1f6766]);_0x498290(!![]);return;}let _0x2365f9={};for(let _0x55f9b3=0x0;_0x55f9b3<_0x39f637[_0x440a('0x17')];_0x55f9b3++){let _0x61f1e8=_0x54e94d[_0x55f9b3]['split'](':');let _0xa34158=_0x61f1e8[_0x61f1e8['length']-0x1];_0x2365f9[_0xa34158]=parseInt(_0x39f637[_0x55f9b3])||0x0;}_0x498290(null,_0x54e94d,_0x2365f9);});},function(_0x3dfccc,_0xebebeb,_0x202629){let _0xcb14=_0x3dfccc[_0x440a('0x11')](function(_0x1bde4a){return[_0x440a('0x12'),_0x1bde4a,_0x440a('0x18')];});redisClient[_0x440a('0x14')](_0xcb14)[_0x440a('0x15')](function(_0x88b83c,_0x45ae23){if(_0x88b83c){log(_0x440a('0xf'),logSystem,'Error\x20with\x20getting\x20minimum\x20payout\x20from\x20redis\x20%j',[_0x88b83c]);_0x202629(!![]);return;}let _0xeff0a1={};for(let _0xed6c9d=0x0;_0xed6c9d<_0x45ae23[_0x440a('0x17')];_0xed6c9d++){let _0x743fe8=_0x3dfccc[_0xed6c9d][_0x440a('0x19')](':');let _0x90790f=_0x743fe8[_0x743fe8[_0x440a('0x17')]-0x1];let _0x535f82=config[_0x440a('0x4')]['minPayment'];let _0x1628b6=config[_0x440a('0x4')][_0x440a('0x1a')];let _0x2949bc=_0x535f82;let _0x2aee9e=parseInt(_0x45ae23[_0xed6c9d])||_0x535f82;if(_0x2aee9e<_0x535f82)_0x2aee9e=_0x535f82;if(_0x1628b6&&_0x2aee9e>_0x1628b6)_0x2aee9e=_0x1628b6;_0xeff0a1[_0x90790f]=_0x2aee9e;if(_0x2aee9e!==_0x2949bc){log(_0x440a('0x6'),logSystem,_0x440a('0x1b'),[utils[_0x440a('0x1c')](_0xeff0a1[_0x90790f]),_0x90790f,utils[_0x440a('0x1c')](_0x2949bc)]);}}_0x202629(null,_0xebebeb,_0xeff0a1);});},function(_0x222b50,_0x2fc2ba,_0x5a54d3){let _0x36ae92={};for(let _0x2883c6 in _0x222b50){let _0xc21ecb=_0x222b50[_0x2883c6];if(_0xc21ecb>=_0x2fc2ba[_0x2883c6]){let _0x2b1874=_0xc21ecb%config['payments'][_0x440a('0x1d')];let _0x149d19=_0xc21ecb-_0x2b1874;if(config['payments'][_0x440a('0x1e')]&&config[_0x440a('0x4')][_0x440a('0x1f')]){_0x149d19-=config[_0x440a('0x4')]['transferFee'];}if(_0x149d19<0x0)continue;_0x36ae92[_0x2883c6]=_0x149d19;}}if(Object[_0x440a('0xc')](_0x36ae92)['length']===0x0){log(_0x440a('0x6'),logSystem,_0x440a('0x20'));_0x5a54d3(!![]);return;}let _0x459ba2=[];let _0x2c7937=0x0;let _0x1dad11=0x0;let _0x458774=0x0;for(let _0x338378 in _0x36ae92){let _0x39382f=parseInt(_0x36ae92[_0x338378]);if(config['payments'][_0x440a('0x21')]&&_0x39382f+_0x1dad11>config['payments'][_0x440a('0x21')]){_0x39382f=config[_0x440a('0x4')][_0x440a('0x21')]-_0x1dad11;}let _0x58e02e=_0x338378;let _0x766a18=null;let _0x3ca89e=![];let _0x2746d2=_0x58e02e[_0x440a('0x19')](config[_0x440a('0x7')]['paymentId'][_0x440a('0x9')]);if(_0x2746d2[_0x440a('0x17')]===0x1&&utils['isIntegratedAddress'](_0x58e02e)||_0x2746d2['length']>=0x2){_0x3ca89e=!![];if(_0x2746d2[_0x440a('0x17')]>=0x2){_0x58e02e=_0x2746d2[0x0];_0x766a18=_0x2746d2[0x1];_0x766a18=_0x766a18[_0x440a('0x22')](/[^A-Za-z0-9]/g,'');if(_0x766a18[_0x440a('0x17')]!==0x10&&_0x766a18[_0x440a('0x17')]!==0x40){_0x3ca89e=![];_0x766a18=null;}}if(_0x2c7937>0x0){_0x458774++;_0x2c7937=0x0;_0x1dad11=0x0;}}if(config['poolServer'][_0x440a('0x23')]&&config[_0x440a('0x7')][_0x440a('0x23')][_0x440a('0x24')]){let _0x2746d2=_0x58e02e[_0x440a('0x19')](config['poolServer'][_0x440a('0x23')][_0x440a('0x9')]);if(_0x2746d2[_0x440a('0x17')]>=0x2)_0x58e02e=_0x2746d2[0x0];}if(!_0x459ba2[_0x458774]){_0x459ba2[_0x458774]={'redis':[],'amount':0x0,'rpc':{'destinations':[],'fee':config[_0x440a('0x4')][_0x440a('0x25')],'mixin':config['payments']['mixin'],'priority':config['payments'][_0x440a('0xa')],'unlock_time':0x0}};}_0x459ba2[_0x458774][_0x440a('0x26')][_0x440a('0x27')][_0x440a('0x28')]({'amount':_0x39382f,'address':_0x58e02e});if(_0x766a18)_0x459ba2[_0x458774][_0x440a('0x26')][_0x440a('0x29')]=_0x766a18;_0x459ba2[_0x458774][_0x440a('0x2a')]['push'](['hincrby',config['coin']+_0x440a('0x2b')+_0x338378,_0x440a('0x13'),-_0x39382f]);if(config[_0x440a('0x4')][_0x440a('0x1e')]&&config[_0x440a('0x4')][_0x440a('0x1f')]){_0x459ba2[_0x458774][_0x440a('0x2a')]['push']([_0x440a('0x2c'),config[_0x440a('0xd')]+_0x440a('0x2b')+_0x338378,_0x440a('0x13'),-config[_0x440a('0x4')][_0x440a('0x25')]]);}_0x459ba2[_0x458774][_0x440a('0x2a')][_0x440a('0x28')]([_0x440a('0x2c'),config['coin']+_0x440a('0x2b')+_0x338378,_0x440a('0x2d'),_0x39382f]);_0x459ba2[_0x458774][_0x440a('0x2e')]+=_0x39382f;_0x2c7937++;_0x1dad11+=_0x39382f;if(config[_0x440a('0x4')]['dynamicTransferFee']){_0x459ba2[_0x458774][_0x440a('0x26')][_0x440a('0x2f')]=config[_0x440a('0x4')][_0x440a('0x25')]*_0x2c7937;}if(_0x2c7937>=config[_0x440a('0x4')][_0x440a('0x30')]||config['payments']['maxTransactionAmount']&&_0x1dad11>=config[_0x440a('0x4')][_0x440a('0x21')]||_0x3ca89e){_0x458774++;_0x2c7937=0x0;_0x1dad11=0x0;}}let _0x55397e=0x0;let _0x148eb0=[];let _0x3ea33f=config['daemonType']?config['daemonType']['toLowerCase']():_0x440a('0x31');async['filter'](_0x459ba2,function(_0x5fc610,_0x542ba9){let _0x3d0420='transfer';let _0x5576fb=_0x5fc610[_0x440a('0x26')];if(_0x3ea33f==='bytecoin'){_0x3d0420=_0x440a('0x32');_0x5576fb={'transfers':_0x5fc610[_0x440a('0x26')][_0x440a('0x27')],'fee':_0x5fc610[_0x440a('0x26')][_0x440a('0x2f')],'anonymity':_0x5fc610[_0x440a('0x26')]['mixin'],'unlockTime':_0x5fc610[_0x440a('0x26')][_0x440a('0x33')]};if(_0x5fc610[_0x440a('0x26')][_0x440a('0x29')]){_0x5576fb['paymentId']=_0x5fc610['rpc'][_0x440a('0x29')];}}apiInterfaces[_0x440a('0x34')](_0x3d0420,_0x5576fb,function(_0x32c0e3,_0x344cdd){if(_0x32c0e3){log(_0x440a('0xf'),logSystem,'Error\x20with\x20%s\x20RPC\x20request\x20to\x20wallet\x20daemon\x20%j',[_0x3d0420,_0x32c0e3]);log(_0x440a('0xf'),logSystem,_0x440a('0x35'),_0x5fc610[_0x440a('0x26')][_0x440a('0x27')]);_0x542ba9(![]);return;}let _0x1c3ec7=_0x55397e++ +Date[_0x440a('0x36')]()/0x3e8|0x0;let _0x38b4af=_0x3ea33f===_0x440a('0x37')?_0x344cdd[_0x440a('0x38')]:_0x344cdd[_0x440a('0x39')];_0x38b4af=_0x38b4af[_0x440a('0x22')]('<','')[_0x440a('0x22')]('>','');_0x5fc610[_0x440a('0x2a')]['push'](['zadd',config[_0x440a('0xd')]+_0x440a('0x3a'),_0x1c3ec7,[_0x38b4af,_0x5fc610[_0x440a('0x2e')],_0x5fc610[_0x440a('0x26')][_0x440a('0x2f')],_0x5fc610[_0x440a('0x26')]['mixin'],Object[_0x440a('0xc')](_0x5fc610[_0x440a('0x26')][_0x440a('0x27')])[_0x440a('0x17')]][_0x440a('0x3b')](':')]);let _0x59f98b=[];for(let _0x5255ff=0x0;_0x5255ff<_0x5fc610[_0x440a('0x26')][_0x440a('0x27')][_0x440a('0x17')];_0x5255ff++){let _0x59afcc=_0x5fc610[_0x440a('0x26')][_0x440a('0x27')][_0x5255ff];if(_0x5fc610[_0x440a('0x26')][_0x440a('0x29')]){_0x59afcc['address']+=config[_0x440a('0x7')][_0x440a('0x8')]['addressSeparator']+_0x5fc610[_0x440a('0x26')]['payment_id'];}_0x5fc610[_0x440a('0x2a')][_0x440a('0x28')]([_0x440a('0x3c'),config[_0x440a('0xd')]+_0x440a('0x3d')+_0x59afcc[_0x440a('0x3e')],_0x1c3ec7,[_0x38b4af,_0x59afcc[_0x440a('0x2e')],_0x5fc610[_0x440a('0x26')][_0x440a('0x2f')],_0x5fc610[_0x440a('0x26')][_0x440a('0x3f')]][_0x440a('0x3b')](':')]);_0x59f98b[_0x440a('0x28')](_0x59afcc);}log(_0x440a('0x6'),logSystem,_0x440a('0x40'),[_0x344cdd]);redisClient[_0x440a('0x14')](_0x5fc610['redis'])[_0x440a('0x15')](function(_0x32c0e3,_0x5147d7){if(_0x32c0e3){log(_0x440a('0xf'),logSystem,_0x440a('0x41'),[_0x32c0e3]);log(_0x440a('0xf'),logSystem,_0x440a('0x42'),_0x5fc610[_0x440a('0x26')][_0x440a('0x27')]);_0x542ba9(![]);return;}for(let _0x2cdeae in _0x59f98b){_0x148eb0[_0x440a('0x28')](_0x59f98b[_0x2cdeae]);}_0x542ba9(!![]);});});},function(_0x50001d){let _0x281057=_0x459ba2[_0x440a('0x17')]-_0x50001d[_0x440a('0x17')];for(let _0x181212 in _0x148eb0){let _0x46da14=_0x148eb0[_0x181212];log(_0x440a('0x6'),logSystem,_0x440a('0x43'),[utils[_0x440a('0x1c')](_0x46da14['amount']),_0x46da14['address']]);notifications[_0x440a('0x44')](_0x46da14['address'],_0x440a('0x45'),{'ADDRESS':_0x46da14[_0x440a('0x3e')][_0x440a('0x46')](0x0,0x7)+_0x440a('0x47')+_0x46da14[_0x440a('0x3e')][_0x440a('0x46')](_0x46da14[_0x440a('0x3e')]['length']-0x7),'AMOUNT':utils['getReadableCoins'](_0x46da14[_0x440a('0x2e')])});}log('info',logSystem,'Payments\x20splintered\x20and\x20%d\x20successfully\x20sent,\x20%d\x20failed',[_0x50001d[_0x440a('0x17')],_0x281057]);_0x5a54d3(null);});}],function(_0x3f39a0,_0x46afc9){setTimeout(runInterval,config[_0x440a('0x4')][_0x440a('0x48')]*0x3e8);});}runInterval();